<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Healthy Recipes</title>
    <style>
        body {
            font-family: 'Playfair Display', serif;
            margin: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
        }
        h1 {
            text-align: center;
            color: black;
            font-size: 70px;
            margin-bottom: 20px;
        }
        .scroll-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 90%;
            max-width: 1200px;
        }
        .price-range {
            font-size: 20px;
            margin: 10px 0;
            color: #555;
        }
        .slider-container {
            width: 100%;
            margin: 20px 0;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        input[type="range"] {
            width: 80%;
            appearance: none;
            height: 6px;
            background: #ddd;
            border-radius: 4px;
            transition: background 0.2s ease;
        }
        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: white;
            border: 4px solid black;
            cursor: pointer;
        }
        .price-value {
            font-size: 20px;
            color: #555;
            margin-top: 10px;
        }
        .recipe-list {
            margin-top: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            width: 100%;
        }
        .recipe-item {
            flex: 1 1 calc(25% - 20px);
            max-width: 250px;
            min-width: 200px;
            background: #f4f4f4;
            border-radius: 5px;
            text-align: center;
            padding: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .recipe-item img {
            width: 250px;
            height: 250px;
            object-fit: cover;
            border-radius: 5px;
        }
        .recipe-item p {
            margin: 10px 0 0;
            color: #666;
            font-size: 14px;
        }
    </style>
</head>
<body>

    <h1>Healthy Recipes</h1>

    <div class="scroll-container">
        <div class="price-range">Price Range:</div>

        <div class="slider-container">
            <span>20</span>
            <input type="range" id="priceSlider" min="20" max="1000" value="20" step="50">
            <span>1000</span>
        </div>

        <div class="price-value">
            Selected Price: <span id="priceDisplay">20</span> Rupees
        </div>

        <div class="recipe-list" id="recipeList">
            <!-- Recipes will appear here -->
        </div>
    </div>

    <script>
        const priceSlider = document.getElementById("priceSlider");
        const priceDisplay = document.getElementById("priceDisplay");
        const recipeList = document.getElementById("recipeList");

        const recipes = [
            { price: 18, name: "Besan Chilla", image: "https://i.pinimg.com/736x/93/c5/49/93c5492c509282be6b7cef80ed2e7179.jpg", link: "besanchilla.html", description: "A healthy and quick pancake made from gram flour and spices" },
            { price: 28, name: "Pongal", image: "https://i.pinimg.com/736x/07/7e/bc/077ebc6ae6cad1dbdb3f610fc893f921.jpg", link: "pongal.html", description: "A nutritious South Indian dish made with rice and lentils." },
            { price: 26, name: "South Indian Idli", image: "https://i.pinimg.com/736x/31/17/79/3117798277633d30993e40fdb344e789.jpg", link: "idly.html", description: "Soft and fluffy steamed rice cakes, perfect for a light meal." },
            { price: 29, name: "Methi Matar Malai", image: "https://sinfullyspicy.com/wp-content/uploads/2023/09/1-4.jpg", link: "methimatarmalai.html", description: "Creamy curry made with fenugreek leaves and peas" },
            { price: 95, name: "Palak Paneer", image: "https://i.pinimg.com/736x/e4/f3/92/e4f392cf4bdd1d68805b2661147491d9.jpg", link: "palakpaneer.html", description: "A spinach-based curry with soft paneer cubes." },
            { price: 11, name: "Cucumber Salad", image: "https://sinfullyspicy.com/wp-content/uploads/2023/07/1.jpg", link: "cucumbersalad.html", description: "A refreshing salad with cucumbers, herbs, and spices." },
            { price: 29, name: "Ragi Dosa", image: "https://www.cookshideout.com/wp-content/uploads/2017/06/Sprouted-Ragi-Dosa1S.jpg", link: "ragidosa.html", description: "A crispy dosa made with ragi flour, rich in calcium." },
            { price: 107, name: "Dal Tadka", image: "https://i.pinimg.com/736x/30/6a/f7/306af751e7d3cf48e6e6e148fe813f4e.jpg", link: "daltadka.html", description: "Spiced lentil curry with aromatic tempering." }
        ];

        function renderhealthy(healthyArray) {
        recipeList.innerHTML = "";
        healthyArray.forEach(healthy => {
            const item = document.createElement("div");
            item.classList.add("recipe-item");
            var filteredRecepies = recipes.filter(ritem => {

                if(ritem.name.toLowerCase() === healthy.name.toLowerCase()){
                    return true;
                }
                return false;
                
            })
            
            item.innerHTML = `
                <a href="${healthy.link || "#"}" target="_blank">
                    <img src="${healthy.image}" alt="${healthy.name}" style="width:200px;height:150px;border-radius:10px;"><br>
                </a>
                <h3>${healthy.name}</h3>
                <p>${healthy.description || ""}</p>
                <p>₹${healthy.price} ${healthy.favourites ? `| ❤️ ${healthy.favourites}` : ""}</p>
            `;
            if(filteredRecepies.length >0){
                 recipeList.appendChild(item);
            }
           
        });
    }

    function updateFromBackend(budget) {
        fetch(`https://budgetrecipe-backend.onrender.com/recipes?budget=${budget}`)
            .then(res => res.json())
            .then(data => {
                if (data.length > 0) {
                    renderhealthy(data);
                } else {
                    renderhealthy([]);
                    recipeList.innerHTML = "<p>No dinner recipes found in this budget range.</p>";
                }
            })
            .catch(err => {
                console.warn("Backend not reachable. Falling back to local data.", err);
                updateFromLocal(budget);
            });
    }

    function updateFromLocal(budget) {
        const filtered = recipes.filter(d => d.price <= budget);
        renderhealthy(filtered);
    }

    slider.addEventListener("input", () => {
        const budget = parseInt(slider.value);
        priceDisplay.textContent = budget;
        updateFromBackend(budget);
    });

    // Initialize
    const initialBudget = parseInt(slider.value);
    priceDisplay.textContent = initialBudget;
    updateFromBackend(initialBudget);
    </script>
</body>
</html>
